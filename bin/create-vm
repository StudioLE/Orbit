#!/bin/bash

# Exit on failure
set -e

# ARGS

TYPE="C1"
MEMORY="8"
CORES="4"
DISK_SIZE="50"
IMG_FILE="jammy-server-cloudimg-amd64.img"
PURPOSE="worker"
OS_NAME="ubuntu"
OS_VERSION="jammy"
NAME="${PURPOSE}-${TYPE}-${OS_NAME}-${OS_VERSION}"
TAGS="${PURPOSE},${TYPE},${OS_NAME},${OS_NAME}-${OS_VERSION}"

# CONSTANTS

DIR="/root/infrastructure"
IMG_FILE="${DIR}/artifacts/${IMG_FILE}"

# START

echo "##### Create a virtual machine"
"${DIR}/lib/create-proxmox-vm" ${MEMORY} ${CORES} ${DISK_SIZE} ${IMG_FILE} ${NAME} ${TAGS}
